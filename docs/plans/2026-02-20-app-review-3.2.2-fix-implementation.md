# App Review 3.2.2 fix implementation plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Send a reply to Apple App Review explaining what KeyJawn is, and land code/metadata changes that remove the 3.2.2 ambiguity so a clean build is ready regardless of appeal outcome.

**Architecture:** Three parallel tracks: (1) immediate Apple reply via App Store Connect, (2) one-file Swift change to rename Category enum cases, (3) screenshot + description update in App Store Connect metadata. Tracks 2 and 3 are bundled into a single commit + new TestFlight build.

**Tech Stack:** Swift 6, KeyJawnKit local Swift package, Xcode 26+, App Store Connect (manual UI), `ios/scripts/asc.py` for API tasks, `ios/scripts/build.sh` for the new build.

**Note on build environment:** The Swift code change can be committed on any machine (Windows/Legion is fine). The `xcodebuild` archive + TestFlight upload in Task 4 **must run on a Mac** with Xcode 26 installed. If working on Legion, commit the code changes and hand off Task 4 to the Mac.

---

## Task 1: Send the Apple reply

**Files:** None (App Store Connect web UI action)

**Step 1: Open the submission thread**

Go to App Store Connect → Your Apps → KeyJawn → App Review submissions → submission `83b2805c-650c-4bf6-91ff-0c6339f36324`. Click "Reply" on the review message.

**Step 2: Send this exact reply**

```
KeyJawn is an SSH terminal keyboard for developers. Its core function is to
send key events (Esc, Tab, Ctrl, arrows) and text to SSH terminal sessions
on servers the user configures.

The "slash commands" panel is a text shortcut picker — tapping a command
inserts a short text string into the active text field (for example, tapping
"/compact" types the literal text "/compact" into the terminal). These are
user-configurable text macros, not links to or representations of any
third-party apps, extensions, or in-app purchases.

The app does not sell, distribute, or link to third-party software. It does
not embed or display third-party apps. It contains no storefront, no download
mechanism, and no ratings or reviews. It is a keyboard with a text-autocomplete
feature.

We have also updated the app's screenshots and category labels in the code
to more clearly communicate this distinction. Happy to provide a demo or
answer any questions.
```

**Step 3: Verify the reply sent**

Confirm the message appears in the thread. The review status will remain "In Review" or "Rejected" until Apple responds — that's expected.

---

## Task 2: Rename slash command categories in Swift

**Files:**
- Modify: `ios/KeyJawnKit/Sources/KeyJawnKit/Models/SlashCommand.swift`

**Context:** The `Category` enum has cases named after third-party tools. The panel doesn't display category labels at runtime, so this change is invisible to users. It removes the ambiguity for reviewers reading source or metadata.

**Step 1: Open the file**

`ios/KeyJawnKit/Sources/KeyJawnKit/Models/SlashCommand.swift`

Current `Category` enum (lines 9-15):
```swift
public enum Category: String, Sendable, CaseIterable {
    case claudeCode = "Claude Code"
    case aider      = "Aider"
    case codex      = "Codex"
    case shell      = "Shell"
    case custom     = "Custom"
}
```

**Step 2: Replace the Category enum**

```swift
public enum Category: String, Sendable, CaseIterable {
    case session = "Session"
    case context = "Context"
    case files   = "Files"
    case shell   = "Shell"
    case custom  = "Custom"
}
```

**Step 3: Update the built-in claudeCode command array**

Change every `category: .claudeCode` to `category: .session`:

```swift
static let claudeCode: [SlashCommand] = [
    SlashCommand(id: "compact",   trigger: "/compact",   description: "Compact context",           category: .session),
    SlashCommand(id: "clear",     trigger: "/clear",     description: "Clear conversation",        category: .session),
    SlashCommand(id: "resume",    trigger: "/resume",    description: "Resume last session",       category: .session),
    SlashCommand(id: "help",      trigger: "/help",      description: "Show help",                 category: .session),
    SlashCommand(id: "review",    trigger: "/review",    description: "Review changes",            category: .session),
    SlashCommand(id: "add",       trigger: "/add",       description: "Add files to context",      category: .session),
    SlashCommand(id: "model",     trigger: "/model",     description: "Switch model",              category: .session),
    SlashCommand(id: "cost",      trigger: "/cost",      description: "Show session cost",         category: .session),
]
```

**Step 4: Update the built-in aider command array**

Change every `category: .aider` to `category: .context`:

```swift
static let aider: [SlashCommand] = [
    SlashCommand(id: "aider-add",  trigger: "/add",   description: "Add file to context", category: .context),
    SlashCommand(id: "aider-drop", trigger: "/drop",  description: "Remove file",         category: .context),
    SlashCommand(id: "aider-run",  trigger: "/run",   description: "Run a shell command", category: .context),
    SlashCommand(id: "aider-ask",  trigger: "/ask",   description: "Ask a question",      category: .context),
    SlashCommand(id: "aider-code", trigger: "/code",  description: "Request code change", category: .context),
    SlashCommand(id: "aider-git",  trigger: "/git",   description: "Run git command",     category: .context),
]
```

**Step 5: Verify no remaining references to old category names**

Search for `.claudeCode`, `.aider`, `.codex` in the `ios/` directory. All should be gone.

```bash
grep -r "\.claudeCode\|\.aider\|\.codex" ios/
# Expected: no output
```

**Step 6: Commit**

```bash
git add ios/KeyJawnKit/Sources/KeyJawnKit/Models/SlashCommand.swift
git commit -m "rename slash command categories to functional terms

Replace tool-branded category names (Claude Code, Aider, Codex) with
functional descriptions (Session, Context, Files). Categories are not
displayed in the panel UI — this change removes third-party branding
from the data model.

Addresses App Review 3.2.2 feedback."
```

---

## Task 3: Replace the branded screenshot

**Files:**
- Replace: `website/public/screenshots/ios-screenshots/ios-claude-code.png`

**Context:** The filename and content of `ios-claude-code.png` likely show Claude Code running prominently, which looks like "here is a supported third-party app." Replace it with a screenshot focused on KeyJawn's keyboard UI itself.

**Step 1: Take a new screenshot** *(requires Mac + Simulator)*

On a Mac with Xcode 26:
1. Run the KeyJawn app in iPhone 17 Pro simulator
2. Open the keyboard in a Notes app or text field
3. Tap the `/` key to show the slash command panel
4. Screenshot: the panel open over the keyboard, showing shortcuts (`/compact`, `/clear`, etc.)
5. The terminal or text field in the background should show a generic command prompt, not Claude Code branding

**Step 2: Save as the replacement file**

```bash
cp ~/Desktop/screenshot.png website/public/screenshots/ios-screenshots/ios-claude-code.png
# Or rename the file to something more accurate:
mv website/public/screenshots/ios-screenshots/ios-claude-code.png \
   website/public/screenshots/ios-screenshots/ios-slash-commands.png
```

If renaming the file, also update any references to it in `website/src/` pages.

**Step 3: Check for references to the filename**

```bash
grep -r "ios-claude-code" website/src/
```

Update any references found.

**Step 4: Commit**

```bash
git add website/public/screenshots/ios-screenshots/
git commit -m "replace branded iOS screenshot with keyboard-focused screenshot

Show the slash command panel UI rather than a specific third-party tool,
to avoid implying KeyJawn is a collection of third-party app integrations."
```

---

## Task 4: Update App Store description copy

**Files:** App Store Connect web UI (no repo files to change unless a description is stored locally)

**Step 1: Check for local description files**

```bash
find . -name "*.txt" -path "*/play/*" -o -name "description*" | grep -v ".git"
```

If there's a description file, edit it. Otherwise go to App Store Connect → KeyJawn → App Store → App Information.

**Step 2: Search for third-party tool name mentions**

Look for phrases like:
- "Claude Code slash commands"
- "Aider slash commands"
- "Codex commands"
- Any sentence that makes it sound like a collection of app integrations

**Step 3: Replace with functional descriptions**

Examples:
- "Claude Code slash commands" → "built-in text shortcuts for CLI session commands"
- "Aider slash commands" → "text shortcuts for code context management"
- "supports Claude Code, Aider, and more" → "works with any CLI tool over SSH"

**Step 4: Save and confirm changes in App Store Connect**

The description update goes live when the next build is submitted for review. No separate save/publish step for the description alone.

---

## Task 5: Build and upload a new TestFlight build

**Note: This task requires a Mac with Xcode 26+, xcpretty, and PyJWT installed.**

**Files:**
- Run: `ios/scripts/build.sh`

**Step 1: Pull latest code on the Mac**

```bash
cd /path/to/keyjawn/ios
git pull origin main
```

**Step 2: Increment the build number in `project.yml`**

Open `ios/project.yml`. Find the build number (e.g., `CURRENT_PROJECT_VERSION: 1`) and increment it. The version string (`MARKETING_VERSION`) stays at `1.0` unless you want to show users a new version number.

```bash
# Check current value
grep -A2 "CURRENT_PROJECT_VERSION" ios/project.yml
```

Edit `project.yml` to bump the build number (e.g., `1` → `2`).

**Step 3: Run the build + upload script**

```bash
cd ios
bash scripts/build.sh
```

Expected output:
```
==> Regenerating Xcode project
==> Archiving
...
==> Exporting IPA
==> IPA: /tmp/KeyJawn-export/KeyJawn.ipa
==> Uploading to TestFlight
...
==> Done. Build will appear in TestFlight once Apple finishes processing (usually 5-15 min).
```

**Step 4: Verify the build appears in TestFlight**

App Store Connect → TestFlight → KeyJawn → Builds. The new build number should appear with status "Processing" within a few minutes, then "Ready to Submit."

**Step 5: Commit the build number bump**

```bash
git add ios/project.yml
git commit -m "bump iOS build number for v1.0 resubmission

Clean build with category rename and updated screenshots."
git push origin main
```

---

## Task 6: Resubmit or wait

**Decision tree:**

```
Apple replies to appeal
├── Approved → Submit the new build as an update when ready
└── Denied / no response after 7 days
    └── Cancel current submission in App Store Connect
        └── Submit new build (from Task 5) for review
            └── In submit dialog: add note "Categories renamed to functional
                terms. Screenshot updated to show keyboard UI only."
```

**If resubmitting:** In App Store Connect → App Review Information → Notes for Review, add:

```
The slash command panel is a text shortcut picker. Tapping any item inserts
a plain text string (e.g. "/compact") into the active text field. No
third-party apps are embedded, linked, or sold. Category labels in the code
have been renamed from tool names to functional terms (Session, Context,
Files) to remove any ambiguity.
```

---

## Verification checklist

Before considering this done:
- [ ] Apple reply sent and confirmed in thread
- [ ] `grep -r "\.claudeCode\|\.aider\|\.codex" ios/` returns no output
- [ ] `ios-claude-code.png` replaced or renamed
- [ ] App Store description has no third-party tool names used as feature marketing
- [ ] New build uploaded to TestFlight with incremented build number
- [ ] Either appeal succeeded or resubmission queued
