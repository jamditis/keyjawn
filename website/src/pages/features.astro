---
import Base from '../layouts/Base.astro';
import KeyCap from '../components/KeyCap.astro';
import FeatureCard from '../components/FeatureCard.astro';
---

<Base
  title="Features -- KeyJawn"
  description="Every feature in KeyJawn: terminal keys, voice input, SCP upload, slash commands, clipboard history, themes, and more."
>
  <section class="section">
    <div class="container">
      <h1 class="page-title">Features</h1>
      <p class="page-intro">Everything the keyboard does. The free version includes terminal keys, voice input, clipboard history, slash commands, swipe gestures, per-app autocorrect, key press preview, and a configurable quick key. The full version ($4) adds SCP upload, multi-host SSH, keyboard themes, customizable extra row keys, a menu panel, clipboard pinning, and custom slash commands.</p>
    </div>
  </section>

  <!-- Terminal keys -->
  <section class="section feature-section" id="terminal-keys">
    <div class="container feature-row">
      <div class="feature-content">
        <h2>Terminal keys</h2>
        <p>A dedicated row above the QWERTY layout with the keys terminals need: <KeyCap label="Esc" />, <KeyCap label="Tab" />, <KeyCap label="Ctrl" />, and arrow keys <KeyCap label="<" /> <KeyCap label=">" />.</p>
        <p>Always visible. No toggling layers or long-pressing to find them. <KeyCap label="Ctrl" /> uses a three-state toggle: tap once to arm it for one keypress, long-press to lock it on, tap again to turn it off. Hold arrow keys to repeat.</p>
        <p>Each key in the row has a distinct background color so you can tell them apart at a glance. Ctrl changes color when armed or locked.</p>
        <p>In the full version, the three left slots (Esc, Tab, Ctrl) are customizable. Long-press to swap them for Home, End, PgUp, PgDn, Insert, Delete, or text characters like <code>|</code>, <code>~</code>, <code>`</code>, <code>\</code>. Also configurable in Settings.</p>
      </div>
      <div class="feature-visual">
        <div class="key-row-demo">
          <KeyCap label="Esc" />
          <KeyCap label="Tab" />
          <KeyCap label="Ctrl" />
          <KeyCap label="<" />
          <KeyCap label=">" />
        </div>
      </div>
    </div>
  </section>

  <!-- Voice input -->
  <section class="section feature-section" id="voice">
    <div class="container feature-row reverse">
      <div class="feature-content">
        <h2>Voice input</h2>
        <p>Tap the mic in the extra row. A waveform animation shows audio level while you speak. Text appears at your cursor as the speech recognizer processes it -- streaming partial results, not waiting for you to finish.</p>
        <p>When 90% of what you type into an AI agent is natural language, speaking is faster than typing on a phone keyboard. Tap stop or the mic again to finish.</p>
        <p class="text-muted" style="font-size: 0.85rem;">Requires microphone permission. Included in both free and full versions.</p>
      </div>
      <div class="feature-visual">
        <div class="voice-demo">
          <div class="waveform">
            <span class="wave-bar" style="--delay: 0s; --height: 60%"></span>
            <span class="wave-bar" style="--delay: 0.1s; --height: 90%"></span>
            <span class="wave-bar" style="--delay: 0.2s; --height: 40%"></span>
            <span class="wave-bar" style="--delay: 0.3s; --height: 75%"></span>
            <span class="wave-bar" style="--delay: 0.4s; --height: 55%"></span>
            <span class="wave-bar" style="--delay: 0.5s; --height: 85%"></span>
            <span class="wave-bar" style="--delay: 0.6s; --height: 45%"></span>
            <span class="wave-bar" style="--delay: 0.7s; --height: 70%"></span>
          </div>
          <code class="voice-text">fix the auth bug in login.ts</code>
        </div>
      </div>
    </div>
  </section>

  <!-- SCP upload -->
  <section class="section feature-section" id="scp-upload">
    <div class="container feature-row">
      <div class="feature-content">
        <h2>SCP upload</h2>
        <p>Configure your SSH hosts in settings. Tap the upload button in the extra row. Pick a photo from your gallery. KeyJawn SCPs it to your server and types the remote file path at your cursor.</p>
        <p>Supports multiple SSH hosts with per-host upload directories. Switch between servers without reconfiguring. All credentials encrypted with AES-256 via AndroidX EncryptedSharedPreferences. Host key verification uses trust-on-first-use and rejects changed keys.</p>
        <p class="text-muted" style="font-size: 0.85rem;">Full version only.</p>
      </div>
      <div class="feature-visual">
        <div class="scp-demo card">
          <code class="scp-flow">
            <span class="text-muted"># you tap upload, pick a photo</span><br/>
            <span class="text-accent">scp</span> photo_001.jpg pi@server:~/uploads/<br/>
            <span class="text-muted"># path typed at cursor:</span><br/>
            ~/uploads/photo_001.jpg<span class="cursor">_</span>
          </code>
        </div>
      </div>
    </div>
  </section>

  <!-- Clipboard -->
  <section class="section feature-section" id="clipboard">
    <div class="container feature-row reverse">
      <div class="feature-content">
        <h2>Clipboard history and pinning</h2>
        <p>Tap the clipboard button in the extra row to see your recent clipboard history (up to 30 items). Tap any entry to paste it at your cursor.</p>
        <p>The full version adds pinning -- pin up to 15 items that persist across sessions and stay at the top of the list. Pinned items are highlighted so you can tell them apart from regular history.</p>
        <p class="text-muted" style="font-size: 0.85rem;">Clipboard history is free. Pinning is full version only.</p>
      </div>
      <div class="feature-visual">
        <div class="clipboard-demo">
          <div class="clip-item clip-pinned">ssh pi@192.168.1.50</div>
          <div class="clip-item">git commit -m "fix auth"</div>
          <div class="clip-item">export API_KEY=sk-...</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Slash commands -->
  <section class="section feature-section" id="slash-commands">
    <div class="container feature-row">
      <div class="feature-content">
        <h2>Slash commands</h2>
        <p>On the symbols layer, the <code>/</code> key opens a command picker instead of typing a literal slash. Select a command to insert it. Dismiss without selecting to type <code>/</code> normally.</p>
        <p>Built-in sets cover Claude Code, OpenClaw, and Gemini CLI. Recently used commands float to the top. The full version lets you create custom command sets -- add commands for your own tools, group them by project, toggle sets on and off.</p>
        <p class="text-muted" style="font-size: 0.85rem;">Built-in sets are free. Custom sets are full version only.</p>
      </div>
      <div class="feature-visual">
        <div class="slash-demo card">
          <div class="cmd-set-header">
            <span class="cmd-set-name">claude-code</span>
            <span class="cmd-set-badge">built-in</span>
          </div>
          <div class="slash-item">/help</div>
          <div class="slash-item">/clear</div>
          <div class="slash-item">/compact</div>
          <div class="slash-item">/review</div>
          <div class="slash-item">/init</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Swipe gestures -->
  <section class="section feature-section" id="swipe">
    <div class="container feature-row reverse">
      <div class="feature-content">
        <h2>Swipe gestures</h2>
        <p>Swipe across the keyboard area for quick actions:</p>
        <ul>
          <li><strong>Swipe left</strong> -- delete word</li>
          <li><strong>Swipe right</strong> -- space</li>
          <li><strong>Swipe up</strong> -- switch to symbols layer</li>
          <li><strong>Swipe down</strong> -- switch to letters layer</li>
        </ul>
      </div>
      <div class="feature-visual">
        <div class="swipe-demo">
          <div class="swipe-arrow swipe-left">
            <span class="swipe-dir">&larr;</span>
            <span class="swipe-label">delete word</span>
          </div>
          <div class="swipe-arrow swipe-right">
            <span class="swipe-dir">&rarr;</span>
            <span class="swipe-label">space</span>
          </div>
          <div class="swipe-arrow swipe-up">
            <span class="swipe-dir">&uarr;</span>
            <span class="swipe-label">symbols</span>
          </div>
          <div class="swipe-arrow swipe-down">
            <span class="swipe-dir">&darr;</span>
            <span class="swipe-label">letters</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Keyboard themes -->
  <section class="section feature-section" id="themes">
    <div class="container feature-row">
      <div class="feature-content">
        <h2>Keyboard themes</h2>
        <p>Four color themes: Dark (the default), Light for outdoor use, OLED black for true-black displays, and Terminal green for the classic look.</p>
        <p>Themes apply to every element -- keys, backgrounds, hints, accent colors, and the extra row. Pick one in the menu panel.</p>
        <p class="text-muted" style="font-size: 0.85rem;">Full version only. Free version uses the Dark theme.</p>
      </div>
      <div class="feature-visual">
        <div class="theme-demo">
          <div class="theme-swatch" style="background: #1B1B1F; border: 2px solid #6C9BF2;">
            <span class="theme-label" style="color: #E8E8EC;">Dark</span>
            <span class="theme-key" style="background: #2B2B30; color: #E8E8EC; border: 1px solid #333338;">A</span>
          </div>
          <div class="theme-swatch" style="background: #E8E8EC; border: 2px solid #2563EB;">
            <span class="theme-label" style="color: #1A1A1F;">Light</span>
            <span class="theme-key" style="background: #FFFFFF; color: #1A1A1F; border: 1px solid #D8D8E0;">A</span>
          </div>
          <div class="theme-swatch" style="background: #000000; border: 2px solid #6C9BF2;">
            <span class="theme-label" style="color: #E8E8EC;">OLED</span>
            <span class="theme-key" style="background: #111114; color: #E8E8EC; border: 1px solid #1A1A1E;">A</span>
          </div>
          <div class="theme-swatch" style="background: #0A1A0A; border: 2px solid #33FF33;">
            <span class="theme-label" style="color: #33FF33;">Term</span>
            <span class="theme-key" style="background: #0F2B0F; color: #33FF33; border: 1px solid #1A3A1A;">A</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Menu panel -->
  <section class="section feature-section" id="menu-panel">
    <div class="container feature-row reverse">
      <div class="feature-content">
        <h2>Menu panel</h2>
        <p>Tap the gear icon in the extra row to open an inline settings overlay. Switch themes, toggle haptic feedback, toggle autocorrect, toggle tooltips, and trigger SCP upload -- all without leaving the keyboard.</p>
        <p>The panel overlays the keyboard rather than replacing it. Tap a setting to change it, or dismiss to go back to typing.</p>
        <p class="text-muted" style="font-size: 0.85rem;">Full version only.</p>
      </div>
      <div class="feature-visual">
        <div class="menu-demo card">
          <div class="menu-section-label">Appearance</div>
          <div class="menu-row">
            <span class="menu-item-label">Theme</span>
            <span class="menu-item-value">Dark</span>
          </div>
          <div class="menu-section-label">Toggles</div>
          <div class="menu-row">
            <span class="menu-item-label">Haptic feedback</span>
            <span class="menu-toggle menu-on">on</span>
          </div>
          <div class="menu-row">
            <span class="menu-item-label">Autocorrect</span>
            <span class="menu-toggle menu-off">off</span>
          </div>
          <div class="menu-row">
            <span class="menu-item-label">Tooltips</span>
            <span class="menu-toggle menu-on">on</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Number row -->
  <section class="section feature-section" id="number-row">
    <div class="container feature-row">
      <div class="feature-content">
        <h2>Number row</h2>
        <p>A dedicated 0-9 row above the QWERTY keys. Long-press any number for its shifted symbol. Small hint labels on each key show you what you'll get.</p>
        <p>No switching layers to type a number. No memorizing which symbol lives where.</p>
      </div>
      <div class="feature-visual">
        <div class="key-row-demo">
          <KeyCap label="1" />
          <KeyCap label="2" />
          <KeyCap label="3" />
          <KeyCap label="4" />
          <KeyCap label="5" />
          <KeyCap label="6" />
          <KeyCap label="7" />
          <KeyCap label="8" />
          <KeyCap label="9" />
          <KeyCap label="0" />
        </div>
      </div>
    </div>
  </section>

  <!-- Alt keys -->
  <section class="section feature-section" id="alt-keys">
    <div class="container feature-row reverse">
      <div class="feature-content">
        <h2>Alt characters</h2>
        <p>Long-press any letter for accented characters and symbol variants. Keys with a single alt character fire immediately. Keys with multiple options show a popup where you slide to pick.</p>
        <p>Examples: long-press <KeyCap label="a" /> for accented variants, <KeyCap label="n" /> for the tilde variant, <KeyCap label="e" /> for accented forms.</p>
      </div>
      <div class="feature-visual">
        <div class="alt-demo">
          <div class="alt-popup-demo">
            <span class="alt-base">a</span>
            <div class="alt-options">
              <span>&#225;</span><span>&#224;</span><span>&#226;</span><span>&#228;</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- More features grid -->
  <section class="section" id="more">
    <div class="container">
      <h2 class="section-heading">And also</h2>
      <div class="more-grid">
        <FeatureCard
          title="symbol-layers"
          icon="{"
          description="Three keyboard layers: lowercase, uppercase, and symbols. The symbols layout follows Samsung-style grouping with a second page for less common characters. Swipe up to switch to symbols, swipe down to go back."
        />
        <FeatureCard
          title="per-app-autocorrect"
          icon="A"
          description="Autocorrect is off by default -- because autocorrect in a terminal is a disaster. Long-press spacebar to toggle it per app. Turn it on for Slack, leave it off for Termux. KeyJawn remembers your setting for each app."
        />
        <FeatureCard
          title="quick-key"
          icon="/"
          description="The bottom-right key next to the spacebar is configurable. Long-press to pick from 24 terminal characters (/, |, ~, `, \, @, #, $, and more) or set custom text up to 8 characters. Also configurable in Settings."
        />
        <FeatureCard
          title="haptic-feedback"
          icon="~"
          description="Optional vibration on key presses. Toggle it in the menu panel or settings. Off by default for a quieter typing experience."
        />
        <FeatureCard
          title="shift-and-caps"
          icon="^"
          description="Tap shift for one uppercase letter -- it auto-returns to lowercase after. Double-tap for caps lock. The key changes appearance to show you which state you're in."
        />
        <FeatureCard
          title="key-preview"
          icon="."
          description="A preview bubble appears above each key on tap, showing the character with a bounce animation. Works on letters, numbers, and symbols across all layers."
        />
        <FeatureCard
          title="configurable-extra-row"
          icon=">"
          description="Long-press ESC, Tab, or Ctrl to swap them for Home, End, PgUp, PgDn, Ins, Del, or custom text. Also configurable in Settings. Full version only."
        />
        <FeatureCard
          title="color-coded-keys"
          icon="="
          description="Each function key in the extra row has a distinct background color. Esc, Tab, Ctrl, arrows, clipboard, upload, and mic are all visually separated so you can find them without reading labels."
        />
      </div>
    </div>
  </section>
</Base>

<style>
  .page-title {
    margin-bottom: var(--space-sm);
  }

  .page-intro {
    color: var(--text);
    font-size: 1.1rem;
    max-width: 680px;
  }

  .feature-section {
    padding: var(--space-xl) 0;
  }

  .feature-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-xl);
    align-items: center;
  }

  .feature-row.reverse .feature-content {
    order: 2;
  }

  .feature-row.reverse .feature-visual {
    order: 1;
  }

  .feature-content h2 {
    margin-bottom: var(--space-sm);
  }

  .feature-content p {
    font-size: 1.05rem;
    line-height: 1.8;
  }

  .feature-content ul {
    margin-top: 0.5rem;
    font-size: 1rem;
  }

  .feature-visual {
    display: flex;
    justify-content: center;
  }

  /* Key row demo */
  .key-row-demo {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
    padding: var(--space-md);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
  }

  .key-row-demo :global(kbd) {
    font-size: 1rem;
    padding: 0.4em 0.8em;
  }

  /* Alt demo */
  .alt-demo {
    padding: var(--space-md);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
  }

  .alt-popup-demo {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
  }

  .alt-base {
    font-family: var(--font-mono);
    font-size: 1.5rem;
    color: #e0e0e8;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(180deg, #2a2a38 0%, #1a1a26 100%);
    border: 1px solid #3a3a4a;
    border-bottom-width: 3px;
    border-radius: 5px;
  }

  .alt-options {
    display: flex;
    gap: 0.25rem;
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 0.25rem;
  }

  .alt-options span {
    font-family: var(--font-mono);
    font-size: 1rem;
    color: var(--text);
    padding: 0.3em 0.5em;
    border-radius: 3px;
  }

  .alt-options span:first-child {
    background: rgba(108, 242, 168, 0.15);
    color: var(--accent);
  }

  /* Voice demo */
  .voice-demo {
    padding: var(--space-md);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    text-align: center;
  }

  .waveform {
    display: flex;
    align-items: end;
    justify-content: center;
    gap: 4px;
    height: 60px;
    margin-bottom: var(--space-sm);
  }

  .wave-bar {
    width: 6px;
    background: var(--accent);
    border-radius: 3px;
    animation: wave 0.8s ease-in-out infinite alternate;
    animation-delay: var(--delay);
    height: var(--height);
    opacity: 0.7;
  }

  @keyframes wave {
    from { transform: scaleY(0.4); }
    to { transform: scaleY(1); }
  }

  .voice-text {
    font-size: 0.85rem;
    color: var(--text);
    background: var(--code-bg);
    border: 1px solid var(--border);
    padding: 0.4em 0.8em;
    border-radius: var(--radius);
  }

  /* Clipboard demo */
  .clipboard-demo {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    padding: var(--space-md);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    min-width: 240px;
  }

  .clip-item {
    font-family: var(--font-mono);
    font-size: 0.8rem;
    color: var(--text);
    padding: 0.6em 0.8em;
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    cursor: pointer;
    transition: border-color 0.2s;
  }

  .clip-pinned {
    border-color: rgba(108, 242, 168, 0.3);
    position: relative;
  }

  .clip-pinned::after {
    content: "pinned";
    font-size: 0.6rem;
    color: var(--accent);
    position: absolute;
    right: 0.6em;
    top: 50%;
    transform: translateY(-50%);
    opacity: 0.7;
  }

  .clip-item:hover {
    border-color: var(--accent);
  }

  /* SCP demo */
  .scp-demo {
    padding: var(--space-md);
  }

  .scp-flow {
    font-size: 0.85rem;
    line-height: 1.8;
    background: none;
    border: none;
    padding: 0;
    display: block;
  }

  /* Slash demo */
  .slash-demo {
    padding: var(--space-sm);
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    min-width: 200px;
  }

  .slash-item {
    font-family: var(--font-mono);
    font-size: 0.85rem;
    color: var(--text);
    padding: 0.5em 0.75em;
    border-radius: var(--radius);
    transition: background 0.2s, color 0.2s;
  }

  .slash-item:first-of-type {
    background: rgba(108, 242, 168, 0.1);
    color: var(--accent);
  }

  .cmd-set-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5em 0.75em;
    margin-bottom: 0.25rem;
  }

  .cmd-set-name {
    font-family: var(--font-mono);
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text);
  }

  .cmd-set-badge {
    font-family: var(--font-mono);
    font-size: 0.65rem;
    color: var(--accent);
    background: rgba(108, 242, 168, 0.1);
    padding: 0.15em 0.5em;
    border-radius: 3px;
    border: 1px solid rgba(108, 242, 168, 0.2);
  }

  /* Swipe demo */
  .swipe-demo {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-sm);
    padding: var(--space-md);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
  }

  .swipe-arrow {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
    padding: 0.75em;
  }

  .swipe-dir {
    font-size: 1.5rem;
    color: var(--accent);
    font-family: var(--font-mono);
  }

  .swipe-label {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    color: var(--text-muted);
  }

  /* Theme demo */
  .theme-demo {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
    padding: var(--space-md);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
  }

  .theme-swatch {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem;
    border-radius: var(--radius);
  }

  .theme-label {
    font-family: var(--font-mono);
    font-size: 0.7rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .theme-key {
    font-family: var(--font-mono);
    font-size: 1rem;
    font-weight: 500;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 5px;
  }

  /* Menu panel demo */
  .menu-demo {
    min-width: 220px;
    padding: var(--space-sm) var(--space-md);
  }

  .menu-section-label {
    font-family: var(--font-mono);
    font-size: 0.7rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    padding: 0.5em 0 0.25em;
    border-bottom: 1px solid var(--border);
    margin-bottom: 0.25rem;
  }

  .menu-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5em 0;
    font-family: var(--font-mono);
    font-size: 0.85rem;
  }

  .menu-item-label {
    color: var(--text);
  }

  .menu-item-value {
    color: var(--text-muted);
    font-size: 0.8rem;
  }

  .menu-toggle {
    font-size: 0.7rem;
    font-weight: 500;
    padding: 0.15em 0.5em;
    border-radius: 3px;
  }

  .menu-on {
    color: var(--accent);
    background: rgba(108, 242, 168, 0.1);
  }

  .menu-off {
    color: var(--text-muted);
    background: rgba(90, 90, 110, 0.15);
  }

  /* More features grid */
  .section-heading {
    margin-bottom: var(--space-lg);
  }

  .more-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-md);
  }

  /* Responsive */
  @media (max-width: 900px) {
    .more-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 768px) {
    .feature-row {
      grid-template-columns: 1fr;
      gap: var(--space-md);
    }

    .feature-row.reverse .feature-content,
    .feature-row.reverse .feature-visual {
      order: unset;
    }
  }

  @media (max-width: 600px) {
    .more-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
